import{aK as q,aL as M,aM as K,p as P,h as G,ah as H,aq as L,q as O,v as U,c as b,o as r,G as f,aN as W,w as d,j as p,at as h,e as c,b as v,k as o,K as J,W as Q}from"./framework.BfoLFm0x.js";import{u as X,l as D,d as C,a as Z,m as ee,V as w,b as x,c as T,e as V,_ as te,f as m,g as ae,h as z}from"./eo-dash.C6HHCnkX.js";import{T as k}from"./index-BaIUJsWt.B6aLOXJn.js";import"./commonjsHelpers.BosuxZz1.js";import"./VTooltip-BBTwQRm7.hW1Ftm2k.js";import"./VOverlay-CxHhPBTC.Ca4cx1aL.js";import"./forwardRefs-BgVXC5TC.DVxUKe0l.js";import"./transition-BAH496pX.BY5sBCwx.js";const se={ref:"rootRef",class:"datePicker"},oe={class:"bg-surface d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ne={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},le=["value"],re={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ie={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},de=["value"],ve={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(l){q(s=>({"4a7baeca":S.value}));const{lgAndDown:g}=X(),B=M("rootRef"),R=M("datePicker"),u=K((s,e)=>({get(){return s(),new Date(C.value).getTime()},set(a){var n;e(),D.debug("Datepicker setting currentDate",C.value);const t=new Date(a);C.value=t.toISOString(),(n=R.value)==null||n.move({month:t.getMonth()+1,year:t.getFullYear()})}})),$=P({input:"YYYY-MM-DD"}),E=s=>{const e=s.getFullYear(),a=s.getMonth()+1,t=s.getDate();return`${e}-${a<10?"0"+a:a}-${t<10?"0"+t:t}`},F=s=>{var e;u.value=new Date((e=s.target)==null?void 0:e.value).getTime()},_=G(()=>E(new Date(u.value))),i=H([]),Y=L(Z(),"selectedStac");O(Y,async(s,e)=>{var a;if(s&&(e==null?void 0:e.id)!==s.id){D.debug("Datepicker selected STAC change triggered"),i.splice(0,i.length);for(let t=0;t<m.length;t++){D.debug("Retrieving dates",m[t]),await m[t].fetchCollection();const n=ae(m[t].getItems());if(!n)continue;const j=[...new Set((a=m[t].getItems())==null?void 0:a.reduce((I,N)=>{const A=Date.parse(N[n]);return A&&I.push(new Date(A)),I},[]))];i.push({key:"id-"+t.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:z[t%z.length]}},dates:j,content:{style:{color:"#000000","font-weight":"bold"}}})}}},{immediate:!0});function y(s){if(i.length){let e=s?1/0:-1/0;i.forEach(a=>{a!=null&&a.dates&&a.dates.forEach(t=>{t instanceof Date&&(e=Math[s?"min":"max"](e,t.getTime()))})}),u.value=e===-1/0?Date.now():e===1/0?0:e}}const S=P("");return U(()=>{S.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),ee(B),(s,e)=>(r(),b("div",se,[f(o(te),{ref:"datePicker",modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),modelModifiers:{number:!0},attributes:i,masks:$.value,expanded:"",class:"bg-surface overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},W({_:2},[l.toggleCalendar?{name:"default",fn:d(({inputValue:a,inputEvents:t})=>[p("div",oe,[l.hideArrows?c("v-if",!0):h((r(),v(w,{key:0,density:"compact",size:o(g)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=n=>y(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:d(()=>[f(x,{icon:[o(T)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to oldest available dataset","bottom"]]),p("div",ne,[l.hideInputField?c("v-if",!0):(r(),b("input",J({key:0,value:a},Q(t,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,le))]),l.hideArrows?c("v-if",!0):h((r(),v(w,{key:1,density:"compact",size:o(g)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=n=>y(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:d(()=>[f(x,{icon:[o(V)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:d(()=>[p("div",re,[l.hideArrows?c("v-if",!0):h((r(),v(w,{key:0,density:"compact",size:o(g)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=a=>y(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:d(()=>[f(x,{icon:[o(T)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to oldest available dataset","bottom"]]),p("div",ie,[l.hideInputField?c("v-if",!0):(r(),b("input",{key:0,value:_.value,onChange:F,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,de))]),l.hideArrows?c("v-if",!0):h((r(),v(w,{key:1,density:"compact",size:o(g)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=a=>y(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:d(()=>[f(x,{icon:[o(V)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{ve as default};
