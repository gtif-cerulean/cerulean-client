import{aH as P,p as A,al as _,ak as O,q as Y,v as N,c as V,G as x,aI as q,w as v,k as m,aJ as H,o as p,j as g,as as w,b as k,e as h,K as j,W as K,B as G,aK as M,a0 as J}from"./framework.DFkVH6j-.js";import{u as L,a as U,m as W,d as B,l as I,V as b,b as $,c as C,e as z,_ as Q,f as D,i as X}from"./eo-dash.B6svuulw.js";import{V as Z}from"./VTooltip-BYTlbKer.D7XO6e8V.js";import"./theme.ChoLGaIE.js";import"./commonjsHelpers.BosuxZz1.js";import"./VOverlay-DUnITwM1.BxBUSMx5.js";import"./forwardRefs-gx1Fzngc.BTnDBAc1.js";import"./transition-j2eWJYMg.D7RTKKYy.js";function ee(t,n){const i=typeof t=="string"?G(t):t,a=te(i,n);return{mounted:a,updated:a,unmounted(l){M(null,l)}}}function te(t,n){return function(i,a,l){var s,u,d;const c=typeof n=="function"?n(a):n,y=((s=a.value)==null?void 0:s.text)??a.value??(c==null?void 0:c.text),f=X(a.value)?a.value:{},o=()=>y??i.textContent,r=(l.ctx===a.instance.$?(u=ae(l,a.instance.$))==null?void 0:u.provides:(d=l.ctx)==null?void 0:d.provides)??a.instance.$.provides,e=J(t,j(c,f),o);e.appContext=Object.assign(Object.create(null),a.instance.$.appContext,{provides:r}),M(e,i)}}function ae(t,n){const i=new Set,a=c=>{var y,f;for(const o of c){if(!o)continue;if(o===t||o.el&&t.el&&o.el===t.el)return!0;i.add(o);let r;if(o.suspense?r=a([o.ssContent]):Array.isArray(o.children)?r=a(o.children):(y=o.component)!=null&&y.vnode&&(r=a([(f=o.component)==null?void 0:f.subTree])),r)return r;i.delete(o)}return!1};if(!a([n.subTree]))return n;const l=Array.from(i).reverse();for(const c of l)if(c.component)return c.component;return n}const S=ee(Z,t=>{var n;return{activator:"parent",location:(n=t.arg)==null?void 0:n.replace("-"," "),text:typeof t.value=="boolean"?void 0:t.value}}),se={class:"bg-surface d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ne={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},oe=["value"],re={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},le={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ie=["value"],he={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(t){H(r=>({ad11927a:o.value}));const{lgAndDown:n}=L(),i=P((r,e)=>({get(){return r(),new Date(B.value).getTime()},set(s){e(),I.debug("Datepicker setting currentDate",B.value),B.value=new Date(s).toISOString()}})),a=A({input:"YYYY-MM-DD"}),l=_([]),c=A(null),y=O(U(),"selectedStac");Y(y,async(r,e)=>{var s;if(r&&(e==null?void 0:e.id)!==r.id){I.debug("Datepicker selected STAC change triggered");const u=["#009E73","#0072B2","#E69F00","#CC79A7","#56B4E9","#D55E00"];l.splice(0,l.length);for(let d=0;d<D.length;d++){I.debug("Retrieving dates",D[d]),await D[d].fetchCollection();const R=[...new Set((s=D[d].getItems())==null?void 0:s.reduce((T,F)=>{const E=Date.parse(F.datetime);return E&&T.push(new Date(E)),T},[]))];l.push({key:"id-"+d.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:u[d%u.length]}},dates:R,content:{style:{color:"#000000","font-weight":"bold"}}})}}},{immediate:!0});function f(r){if(l.length){let e=r?1/0:-1/0;l.forEach(s=>{s!=null&&s.dates&&s.dates.forEach(u=>{u instanceof Date&&(e=Math[r?"min":"max"](e,u.getTime()))})}),i.value=e===-1/0?Date.now():e===1/0?0:e}}const o=A("");return N(()=>{o.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),W(c),(r,e)=>(p(),V("div",{ref_key:"rootRef",ref:c,class:"datePicker"},[x(m(Q),{modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=s=>i.value=s),modelModifiers:{number:!0},attributes:l,masks:a.value,expanded:"",class:"bg-surface overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},q({_:2},[t.toggleCalendar?{name:"default",fn:v(({inputValue:s,inputEvents:u})=>[g("div",se,[t.hideArrows?h("v-if",!0):w((p(),k(C,{key:0,density:"compact",size:m(n)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=d=>f(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:v(()=>[x(b,{icon:[m($)]},null,8,["icon"])]),_:1},8,["size"])),[[S,"Set date to oldest available dataset","bottom"]]),g("div",ne,[t.hideInputField?h("v-if",!0):(p(),V("input",j({key:0,value:s},K(u,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,oe))]),t.hideArrows?h("v-if",!0):w((p(),k(C,{key:1,density:"compact",size:m(n)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=d=>f(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:v(()=>[x(b,{icon:[m(z)]},null,8,["icon"])]),_:1},8,["size"])),[[S,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:v(()=>[g("div",re,[t.hideArrows?h("v-if",!0):w((p(),k(C,{key:0,density:"compact",size:m(n)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=s=>f(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:v(()=>[x(b,{icon:[m($)]},null,8,["icon"])]),_:1},8,["size"])),[[S,"Set date to oldest available dataset","bottom"]]),g("div",le,[t.hideInputField?h("v-if",!0):(p(),V("input",{key:0,value:new Date(i.value).toLocaleDateString(),class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,8,ie))]),t.hideArrows?h("v-if",!0):w((p(),k(C,{key:1,density:"compact",size:m(n)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=s=>f(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:v(()=>[x(b,{icon:[m(z)]},null,8,["icon"])]),_:1},8,["size"])),[[S,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{he as default};
